

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>6. Low Level Data Structure and Algorithms &mdash; Renormalizer 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Static Eigenstate Method" href="static.html" />
    <link rel="prev" title="5. Model" href="model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Renormalizer
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">3. How to develop Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">4. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">5. Model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Low Level Data Structure and Algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#matrix-product-mp">6.1. Matrix Product (MP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrix-product-state-mps">6.2. Matrix Product State (MPS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrix-product-operator-mpo">6.3. Matrix Product Operator (MPO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrix-product-density-matrix-mpdm">6.4. Matrix Product Density Matrix (MPDM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-renormalizer.mps.thermalprop">6.5. Thermal Propagation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="static.html">7. Static Eigenstate Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">8. spectra: absorption/emission spectrum at zero/finite temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="ct.html">9. Charge Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="cv.html">10. Frequency domain DMRG</a></li>
<li class="toctree-l1"><a class="reference internal" href="configs.html">11. Calculation Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">12. lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbm.html">13. sbm</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Renormalizer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">6. </span>Low Level Data Structure and Algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/mps.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="low-level-data-structure-and-algorithms">
<h1><span class="section-number">6. </span>Low Level Data Structure and Algorithms<a class="headerlink" href="#low-level-data-structure-and-algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="matrix-product-mp">
<h2><span class="section-number">6.1. </span>Matrix Product (MP)<a class="headerlink" href="#matrix-product-mp" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.mps.mp.MatrixProduct">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.mps.mp.</code><code class="sig-name descname">MatrixProduct</code><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._array2mt">
<code class="sig-name descname">_array2mt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">idx</span></em>, <em class="sig-param"><span class="n">allow_dump</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._array2mt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._array2mt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._get_big_qn">
<code class="sig-name descname">_get_big_qn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cidx</span><span class="p">:</span> <span class="n">List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._get_big_qn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._get_big_qn" title="Permalink to this definition">¶</a></dt>
<dd><p>get the quantum number of L-block and R-block renormalized basis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cidx</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – a list of center(active) site index. For 1site/2site algorithm, cidx
has one/two elements.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>qnbigl</strong> (<em>np.ndarray</em>) – super-L-block (L-block + active site if necessary) quantum number</p></li>
<li><p><strong>qnbigr</strong> (<em>np.ndarray</em>) – super-R-block (active site + R-block if necessary) quantum number</p></li>
<li><p><strong>qnmat</strong> (<em>np.ndarray</em>) – L-block + active site + R-block quantum number</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._get_sigmaqn">
<code class="sig-name descname">_get_sigmaqn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._get_sigmaqn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._get_sigmaqn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._switch_direction">
<code class="sig-name descname">_switch_direction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._switch_direction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._switch_direction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._update_mps">
<code class="sig-name descname">_update_mps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cstruct</span></em>, <em class="sig-param"><span class="n">cidx</span></em>, <em class="sig-param"><span class="n">qnbigl</span></em>, <em class="sig-param"><span class="n">qnbigr</span></em>, <em class="sig-param"><span class="n">Mmax</span></em>, <em class="sig-param"><span class="n">percent</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._update_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._update_mps" title="Permalink to this definition">¶</a></dt>
<dd><p>update mps with basis selection algorithm of J. Chem. Phys. 120,
3172 (2004).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cstruct</strong> (<em>ndarray</em><em>, </em><em>List</em><em>[</em><em>ndarray</em><em>]</em>) – The active site coefficient.</p></li>
<li><p><strong>cidx</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – The List of active site index.</p></li>
<li><p><strong>qnbigl</strong> (<em>ndarray</em>) – The super-L-block quantum number.</p></li>
<li><p><strong>qnbigr</strong> (<em>ndarray</em>) – The super-R-block quantum number.</p></li>
<li><p><strong>Mmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The maximal bond dimension.</p></li>
<li><p><strong>percent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The percentage of renormalized basis which is equally selected from
each quantum number section rather than according to singular
values. <code class="docutils literal notranslate"><span class="pre">percent</span></code> is defined in <code class="docutils literal notranslate"><span class="pre">procedure</span></code> of
<a class="reference internal" href="configs.html#renormalizer.utils.configs.OptimizeConfig" title="renormalizer.utils.configs.OptimizeConfig"><code class="xref any py py-class docutils literal notranslate"><span class="pre">renormalizer.utils.configs.OptimizeConfig</span></code></a> and <code class="docutils literal notranslate"><span class="pre">vprocedure</span></code> of
<a class="reference internal" href="configs.html#renormalizer.utils.configs.CompressConfig" title="renormalizer.utils.configs.CompressConfig"><code class="xref any py py-class docutils literal notranslate"><span class="pre">renormalizer.utils.configs.CompressConfig</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>if <code class="docutils literal notranslate"><span class="pre">cstruct</span></code> is a list, <code class="docutils literal notranslate"><span class="pre">averaged_ms</span></code> is a list of rotated ms of</dt><dd><p>each element in <code class="docutils literal notranslate"><span class="pre">cstruct</span></code> as a single site calculation. It is
used for better initial guess in SA-DMRG algorithm. Otherwise,
<code class="docutils literal notranslate"><span class="pre">None</span></code> is returned.
<code class="docutils literal notranslate"><span class="pre">self</span></code> is overwritten inplace.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>averaged_ms</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct._update_ms">
<code class="sig-name descname">_update_ms</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em>, <em class="sig-param"><span class="n">u</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">vt</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qnlset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qnrset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">m_trunc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct._update_ms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct._update_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>update mps directly after svd</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.angle">
<code class="sig-name descname">angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.angle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.bond_dims">
<em class="property">property </em><code class="sig-name descname">bond_dims</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.bond_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.bond_dims_mean">
<em class="property">property </em><code class="sig-name descname">bond_dims_mean</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.bond_dims_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.build_empty_mp">
<code class="sig-name descname">build_empty_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.build_empty_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.build_empty_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.build_empty_qn">
<code class="sig-name descname">build_empty_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.build_empty_qn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.build_empty_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.build_none_qn">
<code class="sig-name descname">build_none_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.build_none_qn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.build_none_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.canonicalise">
<code class="sig-name descname">canonicalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.canonicalise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.canonicalise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.check_left_canonical">
<code class="sig-name descname">check_left_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.check_left_canonical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.check_left_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check L-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.check_right_canonical">
<code class="sig-name descname">check_right_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.check_right_canonical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.check_right_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check R-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.clear_qn">
<code class="sig-name descname">clear_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.clear_qn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.clear_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.compress">
<code class="sig-name descname">compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp_m_trunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ret_s</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>inp: canonicalise MPS (or MPO)</p>
<dl class="simple">
<dt>side=’l’: compress LEFT-canonicalised MPS</dt><dd><p>by sweeping from RIGHT to LEFT
output MPS is right canonicalised i.e. CRRR</p>
</dd>
</dl>
<p>side=’r’: reverse of ‘l’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>truncated MPS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.conj">
<code class="sig-name descname">conj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.conj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.conj" title="Permalink to this definition">¶</a></dt>
<dd><p>complex conjugate</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.distance">
<code class="sig-name descname">distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.dot">
<code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>dot product of two mps / mpo</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.ensure_left_canon">
<code class="sig-name descname">ensure_left_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.ensure_left_canon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.ensure_left_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.ensure_right_canon">
<code class="sig-name descname">ensure_right_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.ensure_right_canon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.ensure_right_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_complex">
<em class="property">property </em><code class="sig-name descname">is_complex</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_left_canon">
<em class="property">property </em><code class="sig-name descname">is_left_canon</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_left_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the L-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_mpdm">
<em class="property">property </em><code class="sig-name descname">is_mpdm</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_mpdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_mpo">
<em class="property">property </em><code class="sig-name descname">is_mpo</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_mpo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_mps">
<em class="property">property </em><code class="sig-name descname">is_mps</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.is_right_canon">
<em class="property">property </em><code class="sig-name descname">is_right_canon</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.is_right_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the R-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.iter_idx_list">
<code class="sig-name descname">iter_idx_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span></em>, <em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.iter_idx_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.iter_idx_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.metacopy">
<code class="sig-name descname">metacopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.metacopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.metacopy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.move_qnidx">
<code class="sig-name descname">move_qnidx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dstidx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.move_qnidx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.move_qnidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantum number has a boundary site, left hand of the site is L system qn,
right hand of the side is R system qn, the sum of quantum number of L system
and R system is tot.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.pbond_list">
<em class="property">property </em><code class="sig-name descname">pbond_list</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.pbond_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.set_threshold">
<code class="sig-name descname">set_threshold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.set_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.set_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.site_num">
<em class="property">property </em><code class="sig-name descname">site_num</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.site_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.threshold">
<em class="property">property </em><code class="sig-name descname">threshold</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.to_complex">
<code class="sig-name descname">to_complex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.to_complex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.to_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.total_bytes">
<em class="property">property </em><code class="sig-name descname">total_bytes</code><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.total_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.mp.MatrixProduct.variational_compress">
<code class="sig-name descname">variational_compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mp.html#MatrixProduct.variational_compress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.mp.MatrixProduct.variational_compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Variational compress an mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpo</strong> (<a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a><em>, </em><em>optional</em>) – Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. if mpo is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the returned mps is
an approximation of <code class="docutils literal notranslate"><span class="pre">mpo</span> <span class="pre">&#64;</span> <span class="pre">self</span></code></p></li>
<li><p><strong>guess</strong> (<em>renormalizer.mps.MatrixProduct</em><em>, </em><em>optional</em>) – Initial guess of compressed mps/mpdm/mpo. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the variational compress related configurations is defined in
<code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">guess=None</span></code>, otherwise is defined in <code class="docutils literal notranslate"><span class="pre">guess</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mp</strong> – a new compressed mps/mpdm/mpo, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not overwritten.
<code class="docutils literal notranslate"><span class="pre">guess</span></code> is overwritten.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>renormalizer.mps.MatrixProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="matrix-product-state-mps">
<h2><span class="section-number">6.2. </span>Matrix Product State (MPS)<a class="headerlink" href="#matrix-product-state-mps" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.mps.Mps">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.mps.</code><code class="sig-name descname">Mps</code><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="renormalizer.mps.Mps.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.angle">
<code class="sig-name descname">angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.angle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.bond_dims">
<em class="property">property </em><code class="sig-name descname">bond_dims</code><a class="headerlink" href="#renormalizer.mps.Mps.bond_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.bond_dims_mean">
<em class="property">property </em><code class="sig-name descname">bond_dims_mean</code><a class="headerlink" href="#renormalizer.mps.Mps.bond_dims_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.build_empty_mp">
<code class="sig-name descname">build_empty_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.build_empty_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.build_empty_qn">
<code class="sig-name descname">build_empty_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.build_empty_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.build_none_qn">
<code class="sig-name descname">build_none_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.build_none_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_1site_rdm">
<code class="sig-name descname">calc_1site_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_1site_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_1site_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 1-site reduced density matrix</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\rho_i = \textrm{Tr}_{j \neq i} | \Psi \rangle \langle \Psi|\)</span></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>rdm</strong> – <span class="math notranslate nohighlight">\(\{0:\rho_0, 1:\rho_1, \cdots\}\)</span>. The key is the index of the site.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_2site_mutual_entropy">
<code class="sig-name descname">calc_2site_mutual_entropy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_2site_mutual_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_2site_mutual_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate mutual entropy between two sites.</p>
<p><span class="math notranslate nohighlight">\(m_{ij} = (s_i + s_j - s_{ij})/2\)</span></p>
<p>See Chemical Physics 323 (2006) 519–531</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mutual_entropy</strong> – mutual entropy with shape (nsite, nsite)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2d np.ndarry</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_2site_rdm">
<code class="sig-name descname">calc_2site_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_2site_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_2site_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 2-site reduced density matrix</p>
<p><span class="math notranslate nohighlight">\(\rho_{ij} = \textrm{Tr}_{k \neq i, k \neq j} | \Psi \rangle \langle \Psi |\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>rdm</strong> – <span class="math notranslate nohighlight">\(\{(0,1):\rho_{01}, (0,2):\rho_{02}, \cdots\}\)</span>. The key is a tuple of index of the site.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_bond_entropy">
<code class="sig-name descname">calc_bond_entropy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_bond_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_bond_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate von Neumann entropy at each bond according to <span class="math notranslate nohighlight">\(S = -\textrm{Tr}(\rho \ln \rho)\)</span>
where <span class="math notranslate nohighlight">\(\rho\)</span> is the reduced density matrix of either block.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>S</strong> – a NumPy array containing the entropy values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_edof_rdm">
<code class="sig-name descname">calc_edof_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_edof_rdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_edof_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the reduced density matrix of electronic DoF</p>
<p><span class="math notranslate nohighlight">\(\rho_{ij} = \langle \Psi | a_i^\dagger a_j | \Psi \rangle\)</span></p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.calc_entropy">
<code class="sig-name descname">calc_entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entropy_type</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.calc_entropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.calc_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 1site, 2site, mutual and bond Von Neumann entropy</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\textrm{entropy} = -\textrm{Tr}(\rho \ln \rho)\)</span>
where <span class="math notranslate nohighlight">\(\ln\)</span> stands for natural logarithm.</p>
<p>1site entropy is the entropy between any site and the other
<code class="docutils literal notranslate"><span class="pre">(N-1)</span></code> sites.
2site entropy is the entropy between any two sites and the other
<code class="docutils literal notranslate"><span class="pre">(N-2)</span></code> sites.
mutual entropy characterize the entropy between any two sites.
bond entropy is the entropy between L-block and R-block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>entropy_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – “1site”, “2site”, “mutual”, “bond”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>entropy</strong> – if entropy_type = “1site” or “2site”, a dictionary is returned and the
key is the index or the tuple of index of mps sites, else
an ndarray is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a>, ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.canonical_normalize">
<code class="sig-name descname">canonical_normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.canonical_normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.canonical_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.canonicalise">
<code class="sig-name descname">canonicalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.canonicalise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.check_left_canonical">
<code class="sig-name descname">check_left_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.check_left_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check L-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.check_right_canonical">
<code class="sig-name descname">check_right_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.check_right_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check R-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.clear_qn">
<code class="sig-name descname">clear_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.clear_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.compress">
<code class="sig-name descname">compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp_m_trunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ret_s</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>inp: canonicalise MPS (or MPO)</p>
<dl class="simple">
<dt>side=’l’: compress LEFT-canonicalised MPS</dt><dd><p>by sweeping from RIGHT to LEFT
output MPS is right canonicalised i.e. CRRR</p>
</dd>
</dl>
<p>side=’r’: reverse of ‘l’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>truncated MPS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.conj">
<code class="sig-name descname">conj</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.conj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.conj" title="Permalink to this definition">¶</a></dt>
<dd><p>complex conjugate</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.digest">
<em class="property">property </em><code class="sig-name descname">digest</code><a class="headerlink" href="#renormalizer.mps.Mps.digest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.distance">
<code class="sig-name descname">distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><a class="headerlink" href="#renormalizer.mps.Mps.distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.dmrg_norm">
<em class="property">property </em><code class="sig-name descname">dmrg_norm</code><a class="headerlink" href="#renormalizer.mps.Mps.dmrg_norm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>if self.is_left_canon:</dt><dd><p>assert self.check_left_canonical()
return np.linalg.norm(np.ravel(self[-1]))</p>
</dd>
<dt>else:</dt><dd><p>assert self.check_right_canonical()
return np.linalg.norm(np.ravel(self[0]))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.dot">
<code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><a class="headerlink" href="#renormalizer.mps.Mps.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>dot product of two mps / mpo</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.e_occupations">
<em class="property">property </em><code class="sig-name descname">e_occupations</code><a class="headerlink" href="#renormalizer.mps.Mps.e_occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic occupations <span class="math notranslate nohighlight">\(a^\dagger_i a_i\)</span> for each electronic DoF.
The order is defined by <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_dofs</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.ensure_left_canon">
<code class="sig-name descname">ensure_left_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.ensure_left_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.ensure_right_canon">
<code class="sig-name descname">ensure_right_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.ensure_right_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.evolve">
<code class="sig-name descname">evolve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.evolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.evolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.evolve_exact">
<code class="sig-name descname">evolve_exact</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h_mpo</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em>, <em class="sig-param"><span class="n">space</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.evolve_exact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.evolve_exact" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.expand_bond_dimension">
<code class="sig-name descname">expand_bond_dimension</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hint_mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coef</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">include_ex</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.expand_bond_dimension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.expand_bond_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>expand bond dimension as required in compress_config</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.expectation">
<code class="sig-name descname">expectation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span></em>, <em class="sig-param"><span class="n">self_conj</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><span class="p">]</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.expectation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.expectation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.expectations">
<code class="sig-name descname">expectations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpos</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.expectations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.expectations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.full_wfn">
<code class="sig-name descname">full_wfn</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.array<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.full_wfn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.full_wfn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.ground_state">
<em class="property">classmethod </em><code class="sig-name descname">ground_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">max_entangled</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span></em>, <em class="sig-param"><span class="n">normalize</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">condition</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.ground_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.ground_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain ground state at <span class="math notranslate nohighlight">\(T = 0\)</span> or <span class="math notranslate nohighlight">\(T = \infty\)</span> (maximum entangled).
Electronic DOFs are always at ground state. and vibrational DOFs depend on <code class="docutils literal notranslate"><span class="pre">max_entangled</span></code>.
For Spin-Boson model the electronic DOF also depends on <code class="docutils literal notranslate"><span class="pre">max_entangled</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.Model" title="renormalizer.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – system information.</p></li>
<li><p><strong>max_entangled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – temperature of the vibrational DOFs. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<span class="math notranslate nohighlight">\(T = \infty\)</span> and if set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, <span class="math notranslate nohighlight">\(T = 0\)</span>.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – if the returned Mps are normalized when <code class="docutils literal notranslate"><span class="pre">max_entangled=True</span></code>.
Default is True. If <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code>, the vibrational part is identity.</p></li>
<li><p><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – the same as <a class="reference internal" href="#renormalizer.mps.Mps.hartree_product_state" title="renormalizer.mps.Mps.hartree_product_state"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">hartree_product_state</span></code></a>. only used in ba.BasisMultiElectron
cases to define the occupation. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mps</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps">renormalizer.mps.Mps</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.hartree_product_state">
<em class="property">classmethod </em><code class="sig-name descname">hartree_product_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">condition</span><span class="p">:</span> <span class="n">Dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.hartree_product_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.hartree_product_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Hartree product state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.Model" title="renormalizer.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model information.</p></li>
<li><p><strong>condition</strong> (<em>Dict</em>) – <p>Dict with format <code class="docutils literal notranslate"><span class="pre">{dof:local_state}</span></code>.
The default local state for dofs not specified is the “0” state.
An example is <code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:1,</span> <span class="pre">&quot;v_0&quot;:2,</span> <span class="pre">&quot;v_3&quot;:[0,</span> <span class="pre">0.707,</span> <span class="pre">0.707]}</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are bases that contain multiple dofs in the model, the value of the dict
is the state of all dofs of the basis. For example,
if a basis contains <code class="docutils literal notranslate"><span class="pre">&quot;e_1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;e_2&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;e_3&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">2}</span></code> (<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1]}</span></code>) means <code class="docutils literal notranslate"><span class="pre">&quot;e_3&quot;</span></code> is occupied and
<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">1}</span></code> (<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">0]}</span></code>) means <code class="docutils literal notranslate"><span class="pre">&quot;e_2&quot;</span></code> is occupied.
Be aware that in <code class="xref py py-class docutils literal notranslate"><span class="pre">renormalizer.utils.basis.BasisMultiElectronVac</span></code> the vacuum state
is added to the <code class="docutils literal notranslate"><span class="pre">0</span></code> index.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Constructed mps (<a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_complex">
<em class="property">property </em><code class="sig-name descname">is_complex</code><a class="headerlink" href="#renormalizer.mps.Mps.is_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_left_canon">
<em class="property">property </em><code class="sig-name descname">is_left_canon</code><a class="headerlink" href="#renormalizer.mps.Mps.is_left_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the L-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_mpdm">
<em class="property">property </em><code class="sig-name descname">is_mpdm</code><a class="headerlink" href="#renormalizer.mps.Mps.is_mpdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_mpo">
<em class="property">property </em><code class="sig-name descname">is_mpo</code><a class="headerlink" href="#renormalizer.mps.Mps.is_mpo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_mps">
<em class="property">property </em><code class="sig-name descname">is_mps</code><a class="headerlink" href="#renormalizer.mps.Mps.is_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.is_right_canon">
<em class="property">property </em><code class="sig-name descname">is_right_canon</code><a class="headerlink" href="#renormalizer.mps.Mps.is_right_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the R-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.iter_idx_list">
<code class="sig-name descname">iter_idx_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span></em>, <em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.iter_idx_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">fname</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.metacopy">
<code class="sig-name descname">metacopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.metacopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.metacopy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.move_qnidx">
<code class="sig-name descname">move_qnidx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dstidx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.move_qnidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantum number has a boundary site, left hand of the site is L system qn,
right hand of the side is R system qn, the sum of quantum number of L system
and R system is tot.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.nexciton">
<em class="property">property </em><code class="sig-name descname">nexciton</code><a class="headerlink" href="#renormalizer.mps.Mps.nexciton" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.norm">
<em class="property">property </em><code class="sig-name descname">norm</code><a class="headerlink" href="#renormalizer.mps.Mps.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.pbond_list">
<em class="property">property </em><code class="sig-name descname">pbond_list</code><a class="headerlink" href="#renormalizer.mps.Mps.pbond_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.ph_occupations">
<em class="property">property </em><code class="sig-name descname">ph_occupations</code><a class="headerlink" href="#renormalizer.mps.Mps.ph_occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>phonon occupations <span class="math notranslate nohighlight">\(b^\dagger_i b_i\)</span> for each electronic DoF.
The order is defined by <code class="xref py py-attr docutils literal notranslate"><span class="pre">v_dofs</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.random">
<em class="property">classmethod </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">nexciton</span></em>, <em class="sig-param"><span class="n">m_max</span></em>, <em class="sig-param"><span class="n">percent</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.set_threshold">
<code class="sig-name descname">set_threshold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.set_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.site_num">
<em class="property">property </em><code class="sig-name descname">site_num</code><a class="headerlink" href="#renormalizer.mps.Mps.site_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.threshold">
<em class="property">property </em><code class="sig-name descname">threshold</code><a class="headerlink" href="#renormalizer.mps.Mps.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.to_complex">
<code class="sig-name descname">to_complex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="reference internal" href="_modules/renormalizer/mps/mps.html#Mps.to_complex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mps.to_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.total_bytes">
<em class="property">property </em><code class="sig-name descname">total_bytes</code><a class="headerlink" href="#renormalizer.mps.Mps.total_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mps.variational_compress">
<code class="sig-name descname">variational_compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mps.variational_compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Variational compress an mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpo</strong> (<a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a><em>, </em><em>optional</em>) – Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. if mpo is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the returned mps is
an approximation of <code class="docutils literal notranslate"><span class="pre">mpo</span> <span class="pre">&#64;</span> <span class="pre">self</span></code></p></li>
<li><p><strong>guess</strong> (<em>renormalizer.mps.MatrixProduct</em><em>, </em><em>optional</em>) – Initial guess of compressed mps/mpdm/mpo. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the variational compress related configurations is defined in
<code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">guess=None</span></code>, otherwise is defined in <code class="docutils literal notranslate"><span class="pre">guess</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mp</strong> – a new compressed mps/mpdm/mpo, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not overwritten.
<code class="docutils literal notranslate"><span class="pre">guess</span></code> is overwritten.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>renormalizer.mps.MatrixProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="matrix-product-operator-mpo">
<h2><span class="section-number">6.3. </span>Matrix Product Operator (MPO)<a class="headerlink" href="#matrix-product-operator-mpo" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.mps.Mpo">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.mps.</code><code class="sig-name descname">Mpo</code><span class="sig-paren">(</span><em class="sig-param">model: renormalizer.model.model.Model = None</em>, <em class="sig-param">terms: Union[renormalizer.model.op.Op</em>, <em class="sig-param">List[renormalizer.model.op.Op]] = None</em>, <em class="sig-param">offset: renormalizer.utils.quantity.Quantity = &lt;renormalizer.utils.quantity.Quantity object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix product operator (MPO)</p>
<dl class="py method">
<dt id="renormalizer.mps.Mpo.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.angle">
<code class="sig-name descname">angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.angle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mp</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em>, <em class="sig-param"><span class="n">canonicalise</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.bond_dims">
<em class="property">property </em><code class="sig-name descname">bond_dims</code><a class="headerlink" href="#renormalizer.mps.Mpo.bond_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.bond_dims_mean">
<em class="property">property </em><code class="sig-name descname">bond_dims_mean</code><a class="headerlink" href="#renormalizer.mps.Mpo.bond_dims_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.build_empty_mp">
<code class="sig-name descname">build_empty_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.build_empty_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.build_empty_qn">
<code class="sig-name descname">build_empty_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.build_empty_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.build_none_qn">
<code class="sig-name descname">build_none_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.build_none_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.canonicalise">
<code class="sig-name descname">canonicalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.canonicalise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.check_left_canonical">
<code class="sig-name descname">check_left_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.check_left_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check L-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.check_right_canonical">
<code class="sig-name descname">check_right_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.check_right_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check R-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.clear_qn">
<code class="sig-name descname">clear_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.clear_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.compress">
<code class="sig-name descname">compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp_m_trunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ret_s</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>inp: canonicalise MPS (or MPO)</p>
<dl class="simple">
<dt>side=’l’: compress LEFT-canonicalised MPS</dt><dd><p>by sweeping from RIGHT to LEFT
output MPS is right canonicalised i.e. CRRR</p>
</dd>
</dl>
<p>side=’r’: reverse of ‘l’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>truncated MPS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.conj">
<code class="sig-name descname">conj</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.conj" title="Permalink to this definition">¶</a></dt>
<dd><p>complex conjugate</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.conj_trans">
<code class="sig-name descname">conj_trans</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.conj_trans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.conj_trans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.contract">
<code class="sig-name descname">contract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span></em>, <em class="sig-param"><span class="n">algo</span><span class="o">=</span><span class="default_value">'svd'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.contract" title="Permalink to this definition">¶</a></dt>
<dd><p>an approximation of mpo &#64; mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mps</strong> (<a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a>, <a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mpo</span></code></a>, <a class="reference internal" href="#renormalizer.mps.MpDm" title="renormalizer.mps.MpDm"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MpDm</span></code></a>) – </p></li>
<li><p><strong>algo</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The algorithm to compress mpo &#64; mps/mpdm/mpo.  It could be <code class="docutils literal notranslate"><span class="pre">svd</span></code>
(default) and <code class="docutils literal notranslate"><span class="pre">variational</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_mps</strong> – an approximation of mpo &#64; mps/mpdm/mpo. The input <code class="docutils literal notranslate"><span class="pre">mps</span></code> is not
overwritten.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct.compress" title="renormalizer.mps.mp.MatrixProduct.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.mps.mp.MatrixProduct.compress</span></code></a></dt><dd><p>svd compression.</p>
</dd>
<dt><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct.variational_compress" title="renormalizer.mps.mp.MatrixProduct.variational_compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.mps.mp.MatrixProduct.variational_compress</span></code></a></dt><dd><p>variational compression.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.digest">
<em class="property">property </em><code class="sig-name descname">digest</code><a class="headerlink" href="#renormalizer.mps.Mpo.digest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.distance">
<code class="sig-name descname">distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><a class="headerlink" href="#renormalizer.mps.Mpo.distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.dmrg_norm">
<em class="property">property </em><code class="sig-name descname">dmrg_norm</code><a class="headerlink" href="#renormalizer.mps.Mpo.dmrg_norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.dot">
<code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><a class="headerlink" href="#renormalizer.mps.Mpo.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>dot product of two mps / mpo</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.dummy_qn">
<em class="property">property </em><code class="sig-name descname">dummy_qn</code><a class="headerlink" href="#renormalizer.mps.Mpo.dummy_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.ensure_left_canon">
<code class="sig-name descname">ensure_left_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.ensure_left_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.ensure_right_canon">
<code class="sig-name descname">ensure_right_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.ensure_right_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.exact_propagator">
<em class="property">classmethod </em><code class="sig-name descname">exact_propagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.HolsteinModel</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">space</span><span class="o">=</span><span class="default_value">'GS'</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.exact_propagator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.exact_propagator" title="Permalink to this definition">¶</a></dt>
<dd><p>construct the GS space propagator e^{xH} exact MPO
H=sum_{in} omega_{in} b^dagger_{in} b_{in}
fortunately, the H is local. so e^{xH} = e^{xh1}e^{xh2}…e^{xhn}
the bond dimension is 1
shift is the a constant for H+shift</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.finiteT_cv">
<em class="property">classmethod </em><code class="sig-name descname">finiteT_cv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">nexciton</span></em>, <em class="sig-param"><span class="n">m_max</span></em>, <em class="sig-param"><span class="n">spectratype</span></em>, <em class="sig-param"><span class="n">percent</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.finiteT_cv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.finiteT_cv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.from_mp">
<em class="property">classmethod </em><code class="sig-name descname">from_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">mp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.from_mp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.from_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.full_operator">
<code class="sig-name descname">full_operator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.full_operator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.full_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.identity">
<em class="property">classmethod </em><code class="sig-name descname">identity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.identity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.identity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.intersite">
<em class="property">classmethod </em><code class="sig-name descname">intersite</code><span class="sig-paren">(</span><em class="sig-param">model: renormalizer.model.model.HolsteinModel</em>, <em class="sig-param">e_opera: dict</em>, <em class="sig-param">ph_opera: dict</em>, <em class="sig-param">scale: renormalizer.utils.quantity.Quantity = &lt;renormalizer.utils.quantity.Quantity object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.intersite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.intersite" title="Permalink to this definition">¶</a></dt>
<dd><p>construct the inter site MPO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.HolsteinModel" title="renormalizer.model.HolsteinModel"><em>HolsteinModel</em></a>) – the molecular information</p></li>
<li><p><strong>e_opera</strong> – the electronic operators. {imol: operator}, such as {1:”a”, 3:r”a^dagger”}</p></li>
<li><p><strong>ph_opera</strong> – the vibrational operators. {(imol, iph): operator}, such as {(0,5):”b”}</p></li>
<li><p><strong>scale</strong> (<em>Quantity</em>) – scalar to scale the mpo</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the operator index starts from 0,1,2…</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_complex">
<em class="property">property </em><code class="sig-name descname">is_complex</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_hermitian">
<code class="sig-name descname">is_hermitian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.is_hermitian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.is_hermitian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_left_canon">
<em class="property">property </em><code class="sig-name descname">is_left_canon</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_left_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the L-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_mpdm">
<em class="property">property </em><code class="sig-name descname">is_mpdm</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_mpdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_mpo">
<em class="property">property </em><code class="sig-name descname">is_mpo</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_mpo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_mps">
<em class="property">property </em><code class="sig-name descname">is_mps</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.is_right_canon">
<em class="property">property </em><code class="sig-name descname">is_right_canon</code><a class="headerlink" href="#renormalizer.mps.Mpo.is_right_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the R-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.iter_idx_list">
<code class="sig-name descname">iter_idx_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span></em>, <em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.iter_idx_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.metacopy">
<code class="sig-name descname">metacopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.metacopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.metacopy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.move_qnidx">
<code class="sig-name descname">move_qnidx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dstidx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.move_qnidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantum number has a boundary site, left hand of the site is L system qn,
right hand of the side is R system qn, the sum of quantum number of L system
and R system is tot.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.onsite">
<em class="property">classmethod </em><code class="sig-name descname">onsite</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">opera</span></em>, <em class="sig-param"><span class="n">dipole</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dof_set</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.onsite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.onsite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.pbond_list">
<em class="property">property </em><code class="sig-name descname">pbond_list</code><a class="headerlink" href="#renormalizer.mps.Mpo.pbond_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.ph_onsite">
<em class="property">classmethod </em><code class="sig-name descname">ph_onsite</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.HolsteinModel</span></em>, <em class="sig-param"><span class="n">opera</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em>, <em class="sig-param"><span class="n">mol_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em>, <em class="sig-param"><span class="n">ph_idx</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.ph_onsite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.ph_onsite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.promote_mt_type">
<code class="sig-name descname">promote_mt_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpo.html#Mpo.promote_mt_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.Mpo.promote_mt_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.set_threshold">
<code class="sig-name descname">set_threshold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.set_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.site_num">
<em class="property">property </em><code class="sig-name descname">site_num</code><a class="headerlink" href="#renormalizer.mps.Mpo.site_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.threshold">
<em class="property">property </em><code class="sig-name descname">threshold</code><a class="headerlink" href="#renormalizer.mps.Mpo.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.to_complex">
<code class="sig-name descname">to_complex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.to_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.total_bytes">
<em class="property">property </em><code class="sig-name descname">total_bytes</code><a class="headerlink" href="#renormalizer.mps.Mpo.total_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.Mpo.variational_compress">
<code class="sig-name descname">variational_compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.Mpo.variational_compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Variational compress an mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpo</strong> (<a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a><em>, </em><em>optional</em>) – Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. if mpo is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the returned mps is
an approximation of <code class="docutils literal notranslate"><span class="pre">mpo</span> <span class="pre">&#64;</span> <span class="pre">self</span></code></p></li>
<li><p><strong>guess</strong> (<em>renormalizer.mps.MatrixProduct</em><em>, </em><em>optional</em>) – Initial guess of compressed mps/mpdm/mpo. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the variational compress related configurations is defined in
<code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">guess=None</span></code>, otherwise is defined in <code class="docutils literal notranslate"><span class="pre">guess</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mp</strong> – a new compressed mps/mpdm/mpo, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not overwritten.
<code class="docutils literal notranslate"><span class="pre">guess</span></code> is overwritten.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>renormalizer.mps.MatrixProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="matrix-product-density-matrix-mpdm">
<h2><span class="section-number">6.4. </span>Matrix Product Density Matrix (MPDM)<a class="headerlink" href="#matrix-product-density-matrix-mpdm" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.mps.MpDm">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.mps.</code><code class="sig-name descname">MpDm</code><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="renormalizer.mps.MpDm.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.angle">
<code class="sig-name descname">angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.angle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.apply">
<code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mp</span></em>, <em class="sig-param"><span class="n">canonicalise</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; MpDmBase<a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.apply" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.bond_dims">
<em class="property">property </em><code class="sig-name descname">bond_dims</code><a class="headerlink" href="#renormalizer.mps.MpDm.bond_dims" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.bond_dims_mean">
<em class="property">property </em><code class="sig-name descname">bond_dims_mean</code><a class="headerlink" href="#renormalizer.mps.MpDm.bond_dims_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.build_empty_mp">
<code class="sig-name descname">build_empty_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.build_empty_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.build_empty_qn">
<code class="sig-name descname">build_empty_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.build_empty_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.build_none_qn">
<code class="sig-name descname">build_none_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.build_none_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_1site_rdm">
<code class="sig-name descname">calc_1site_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.calc_1site_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 1-site reduced density matrix</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\rho_i = \textrm{Tr}_{j \neq i} | \Psi \rangle \langle \Psi|\)</span></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>rdm</strong> – <span class="math notranslate nohighlight">\(\{0:\rho_0, 1:\rho_1, \cdots\}\)</span>. The key is the index of the site.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_2site_mutual_entropy">
<code class="sig-name descname">calc_2site_mutual_entropy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.calc_2site_mutual_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate mutual entropy between two sites.</p>
<p><span class="math notranslate nohighlight">\(m_{ij} = (s_i + s_j - s_{ij})/2\)</span></p>
<p>See Chemical Physics 323 (2006) 519–531</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mutual_entropy</strong> – mutual entropy with shape (nsite, nsite)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>2d np.ndarry</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_2site_rdm">
<code class="sig-name descname">calc_2site_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.calc_2site_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 2-site reduced density matrix</p>
<p><span class="math notranslate nohighlight">\(\rho_{ij} = \textrm{Tr}_{k \neq i, k \neq j} | \Psi \rangle \langle \Psi |\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>rdm</strong> – <span class="math notranslate nohighlight">\(\{(0,1):\rho_{01}, (0,2):\rho_{02}, \cdots\}\)</span>. The key is a tuple of index of the site.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_bond_entropy">
<code class="sig-name descname">calc_bond_entropy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#renormalizer.mps.MpDm.calc_bond_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate von Neumann entropy at each bond according to <span class="math notranslate nohighlight">\(S = -\textrm{Tr}(\rho \ln \rho)\)</span>
where <span class="math notranslate nohighlight">\(\rho\)</span> is the reduced density matrix of either block.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>S</strong> – a NumPy array containing the entropy values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_edof_rdm">
<code class="sig-name descname">calc_edof_rdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#renormalizer.mps.MpDm.calc_edof_rdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the reduced density matrix of electronic DoF</p>
<p><span class="math notranslate nohighlight">\(\rho_{ij} = \langle \Psi | a_i^\dagger a_j | \Psi \rangle\)</span></p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.calc_entropy">
<code class="sig-name descname">calc_entropy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">entropy_type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.calc_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate 1site, 2site, mutual and bond Von Neumann entropy</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\textrm{entropy} = -\textrm{Tr}(\rho \ln \rho)\)</span>
where <span class="math notranslate nohighlight">\(\ln\)</span> stands for natural logarithm.</p>
<p>1site entropy is the entropy between any site and the other
<code class="docutils literal notranslate"><span class="pre">(N-1)</span></code> sites.
2site entropy is the entropy between any two sites and the other
<code class="docutils literal notranslate"><span class="pre">(N-2)</span></code> sites.
mutual entropy characterize the entropy between any two sites.
bond entropy is the entropy between L-block and R-block.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>entropy_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – “1site”, “2site”, “mutual”, “bond”</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>entropy</strong> – if entropy_type = “1site” or “2site”, a dictionary is returned and the
key is the index or the tuple of index of mps sites, else
an ndarray is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a>, ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.canonical_normalize">
<code class="sig-name descname">canonical_normalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.canonical_normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.canonicalise">
<code class="sig-name descname">canonicalise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.canonicalise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.check_left_canonical">
<code class="sig-name descname">check_left_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.check_left_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check L-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.check_right_canonical">
<code class="sig-name descname">check_right_canonical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.check_right_canonical" title="Permalink to this definition">¶</a></dt>
<dd><p>check R-canonical</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.clear_qn">
<code class="sig-name descname">clear_qn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.clear_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.compress">
<code class="sig-name descname">compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temp_m_trunc</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ret_s</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.compress" title="Permalink to this definition">¶</a></dt>
<dd><p>inp: canonicalise MPS (or MPO)</p>
<dl class="simple">
<dt>side=’l’: compress LEFT-canonicalised MPS</dt><dd><p>by sweeping from RIGHT to LEFT
output MPS is right canonicalised i.e. CRRR</p>
</dd>
</dl>
<p>side=’r’: reverse of ‘l’</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>truncated MPS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.conj">
<code class="sig-name descname">conj</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="headerlink" href="#renormalizer.mps.MpDm.conj" title="Permalink to this definition">¶</a></dt>
<dd><p>complex conjugate</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.conj_trans">
<code class="sig-name descname">conj_trans</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.conj_trans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.conj_trans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.contract">
<code class="sig-name descname">contract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span></em>, <em class="sig-param"><span class="n">algo</span><span class="o">=</span><span class="default_value">'svd'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.contract" title="Permalink to this definition">¶</a></dt>
<dd><p>an approximation of mpo &#64; mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mps</strong> (<a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a>, <a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mpo</span></code></a>, <a class="reference internal" href="#renormalizer.mps.MpDm" title="renormalizer.mps.MpDm"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MpDm</span></code></a>) – </p></li>
<li><p><strong>algo</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – The algorithm to compress mpo &#64; mps/mpdm/mpo.  It could be <code class="docutils literal notranslate"><span class="pre">svd</span></code>
(default) and <code class="docutils literal notranslate"><span class="pre">variational</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new_mps</strong> – an approximation of mpo &#64; mps/mpdm/mpo. The input <code class="docutils literal notranslate"><span class="pre">mps</span></code> is not
overwritten.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct.compress" title="renormalizer.mps.mp.MatrixProduct.compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.mps.mp.MatrixProduct.compress</span></code></a></dt><dd><p>svd compression.</p>
</dd>
<dt><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct.variational_compress" title="renormalizer.mps.mp.MatrixProduct.variational_compress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">renormalizer.mps.mp.MatrixProduct.variational_compress</span></code></a></dt><dd><p>variational compression.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.digest">
<em class="property">property </em><code class="sig-name descname">digest</code><a class="headerlink" href="#renormalizer.mps.MpDm.digest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.distance">
<code class="sig-name descname">distance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><a class="headerlink" href="#renormalizer.mps.MpDm.distance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.dmrg_norm">
<em class="property">property </em><code class="sig-name descname">dmrg_norm</code><a class="headerlink" href="#renormalizer.mps.MpDm.dmrg_norm" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>if self.is_left_canon:</dt><dd><p>assert self.check_left_canonical()
return np.linalg.norm(np.ravel(self[-1]))</p>
</dd>
<dt>else:</dt><dd><p>assert self.check_right_canonical()
return np.linalg.norm(np.ravel(self[0]))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.dot">
<code class="sig-name descname">dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.mps.mp.MatrixProduct" title="renormalizer.mps.mp.MatrixProduct">renormalizer.mps.mp.MatrixProduct</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><a class="headerlink" href="#renormalizer.mps.MpDm.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>dot product of two mps / mpo</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.dummy_qn">
<em class="property">property </em><code class="sig-name descname">dummy_qn</code><a class="headerlink" href="#renormalizer.mps.MpDm.dummy_qn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.dump" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.e_occupations">
<em class="property">property </em><code class="sig-name descname">e_occupations</code><a class="headerlink" href="#renormalizer.mps.MpDm.e_occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>Electronic occupations <span class="math notranslate nohighlight">\(a^\dagger_i a_i\)</span> for each electronic DoF.
The order is defined by <code class="xref py py-attr docutils literal notranslate"><span class="pre">e_dofs</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.ensure_left_canon">
<code class="sig-name descname">ensure_left_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.ensure_left_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.ensure_right_canon">
<code class="sig-name descname">ensure_right_canon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.ensure_right_canon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.evolve">
<code class="sig-name descname">evolve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="headerlink" href="#renormalizer.mps.MpDm.evolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.evolve_exact">
<code class="sig-name descname">evolve_exact</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">h_mpo</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em>, <em class="sig-param"><span class="n">space</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.evolve_exact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.evolve_exact" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.exact_propagator">
<em class="property">classmethod </em><code class="sig-name descname">exact_propagator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.HolsteinModel</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">space</span><span class="o">=</span><span class="default_value">'GS'</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.exact_propagator" title="Permalink to this definition">¶</a></dt>
<dd><p>construct the GS space propagator e^{xH} exact MPO
H=sum_{in} omega_{in} b^dagger_{in} b_{in}
fortunately, the H is local. so e^{xH} = e^{xh1}e^{xh2}…e^{xhn}
the bond dimension is 1
shift is the a constant for H+shift</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.expand_bond_dimension">
<code class="sig-name descname">expand_bond_dimension</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hint_mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">coef</span><span class="o">=</span><span class="default_value">1e-10</span></em>, <em class="sig-param"><span class="n">include_ex</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.expand_bond_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>expand bond dimension as required in compress_config</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.expectation">
<code class="sig-name descname">expectation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span></em>, <em class="sig-param"><span class="n">self_conj</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)">float</a><span class="p">, </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.9)">complex</a><span class="p">]</span><a class="headerlink" href="#renormalizer.mps.MpDm.expectation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.expectations">
<code class="sig-name descname">expectations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpos</span></em>, <em class="sig-param"><span class="n">opt</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#renormalizer.mps.MpDm.expectations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.finiteT_cv">
<em class="property">classmethod </em><code class="sig-name descname">finiteT_cv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">nexciton</span></em>, <em class="sig-param"><span class="n">m_max</span></em>, <em class="sig-param"><span class="n">spectratype</span></em>, <em class="sig-param"><span class="n">percent</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.finiteT_cv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.from_mp">
<em class="property">classmethod </em><code class="sig-name descname">from_mp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">mp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.from_mp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.from_mps">
<em class="property">classmethod </em><code class="sig-name descname">from_mps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span><span class="p">:</span> <span class="n">renormalizer.mps.mps.Mps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.from_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.from_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.full_operator">
<code class="sig-name descname">full_operator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.full_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.full_wfn">
<code class="sig-name descname">full_wfn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.full_wfn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.full_wfn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.ground_state">
<em class="property">classmethod </em><code class="sig-name descname">ground_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">max_entangled</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.ground_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.ground_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain ground state at <span class="math notranslate nohighlight">\(T = 0\)</span> or <span class="math notranslate nohighlight">\(T = \infty\)</span> (maximum entangled).
Electronic DOFs are always at ground state. and vibrational DOFs depend on <code class="docutils literal notranslate"><span class="pre">max_entangled</span></code>.
For Spin-Boson model the electronic DOF also depends on <code class="docutils literal notranslate"><span class="pre">max_entangled</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.Model" title="renormalizer.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – system information.</p></li>
<li><p><strong>max_entangled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – temperature of the vibrational DOFs. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>,
<span class="math notranslate nohighlight">\(T = \infty\)</span> and if set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, <span class="math notranslate nohighlight">\(T = 0\)</span>.</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – if the returned Mps are normalized when <code class="docutils literal notranslate"><span class="pre">max_entangled=True</span></code>.
Default is True. If <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code>, the vibrational part is identity.</p></li>
<li><p><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – the same as <a class="reference internal" href="#renormalizer.mps.MpDm.hartree_product_state" title="renormalizer.mps.MpDm.hartree_product_state"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">hartree_product_state</span></code></a>. only used in ba.BasisMultiElectron
cases to define the occupation. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mps</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps">renormalizer.mps.Mps</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.hartree_product_state">
<em class="property">classmethod </em><code class="sig-name descname">hartree_product_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">condition</span><span class="p">:</span> <span class="n">Dict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.hartree_product_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Hartree product state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.Model" title="renormalizer.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – Model information.</p></li>
<li><p><strong>condition</strong> (<em>Dict</em>) – <p>Dict with format <code class="docutils literal notranslate"><span class="pre">{dof:local_state}</span></code>.
The default local state for dofs not specified is the “0” state.
An example is <code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:1,</span> <span class="pre">&quot;v_0&quot;:2,</span> <span class="pre">&quot;v_3&quot;:[0,</span> <span class="pre">0.707,</span> <span class="pre">0.707]}</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are bases that contain multiple dofs in the model, the value of the dict
is the state of all dofs of the basis. For example,
if a basis contains <code class="docutils literal notranslate"><span class="pre">&quot;e_1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;e_2&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;e_3&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">2}</span></code> (<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">1]}</span></code>) means <code class="docutils literal notranslate"><span class="pre">&quot;e_3&quot;</span></code> is occupied and
<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">1}</span></code> (<code class="docutils literal notranslate"><span class="pre">{&quot;e_1&quot;:</span> <span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">0]}</span></code>) means <code class="docutils literal notranslate"><span class="pre">&quot;e_2&quot;</span></code> is occupied.
Be aware that in <code class="xref py py-class docutils literal notranslate"><span class="pre">renormalizer.utils.basis.BasisMultiElectronVac</span></code> the vacuum state
is added to the <code class="docutils literal notranslate"><span class="pre">0</span></code> index.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Constructed mps (<a class="reference internal" href="#renormalizer.mps.Mps" title="renormalizer.mps.Mps"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mps</span></code></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.identity">
<em class="property">classmethod </em><code class="sig-name descname">identity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.identity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.intersite">
<em class="property">classmethod </em><code class="sig-name descname">intersite</code><span class="sig-paren">(</span><em class="sig-param">model: renormalizer.model.model.HolsteinModel</em>, <em class="sig-param">e_opera: dict</em>, <em class="sig-param">ph_opera: dict</em>, <em class="sig-param">scale: renormalizer.utils.quantity.Quantity = &lt;renormalizer.utils.quantity.Quantity object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.intersite" title="Permalink to this definition">¶</a></dt>
<dd><p>construct the inter site MPO</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.HolsteinModel" title="renormalizer.model.HolsteinModel"><em>HolsteinModel</em></a>) – the molecular information</p></li>
<li><p><strong>e_opera</strong> – the electronic operators. {imol: operator}, such as {1:”a”, 3:r”a^dagger”}</p></li>
<li><p><strong>ph_opera</strong> – the vibrational operators. {(imol, iph): operator}, such as {(0,5):”b”}</p></li>
<li><p><strong>scale</strong> (<em>Quantity</em>) – scalar to scale the mpo</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the operator index starts from 0,1,2…</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_complex">
<em class="property">property </em><code class="sig-name descname">is_complex</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_hermitian">
<code class="sig-name descname">is_hermitian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.is_hermitian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_left_canon">
<em class="property">property </em><code class="sig-name descname">is_left_canon</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_left_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the L-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_mpdm">
<em class="property">property </em><code class="sig-name descname">is_mpdm</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_mpdm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_mpo">
<em class="property">property </em><code class="sig-name descname">is_mpo</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_mpo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_mps">
<em class="property">property </em><code class="sig-name descname">is_mps</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.is_right_canon">
<em class="property">property </em><code class="sig-name descname">is_right_canon</code><a class="headerlink" href="#renormalizer.mps.MpDm.is_right_canon" title="Permalink to this definition">¶</a></dt>
<dd><p>check the qn center in the R-canonical structure</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.iter_idx_list">
<code class="sig-name descname">iter_idx_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">full</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span></em>, <em class="sig-param"><span class="n">stop_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.iter_idx_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">fname</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.max_entangled_ex">
<em class="property">classmethod </em><code class="sig-name descname">max_entangled_ex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.max_entangled_ex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.max_entangled_ex" title="Permalink to this definition">¶</a></dt>
<dd><p>T = infty locally maximal entangled EX state</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.max_entangled_gs">
<em class="property">classmethod </em><code class="sig-name descname">max_entangled_gs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mpdm.MpDm<a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.max_entangled_gs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.max_entangled_gs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.metacopy">
<code class="sig-name descname">metacopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="headerlink" href="#renormalizer.mps.MpDm.metacopy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.move_qnidx">
<code class="sig-name descname">move_qnidx</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dstidx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.move_qnidx" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantum number has a boundary site, left hand of the site is L system qn,
right hand of the side is R system qn, the sum of quantum number of L system
and R system is tot.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.nexciton">
<em class="property">property </em><code class="sig-name descname">nexciton</code><a class="headerlink" href="#renormalizer.mps.MpDm.nexciton" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.norm">
<em class="property">property </em><code class="sig-name descname">norm</code><a class="headerlink" href="#renormalizer.mps.MpDm.norm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">norm</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.normalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.onsite">
<em class="property">classmethod </em><code class="sig-name descname">onsite</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">opera</span></em>, <em class="sig-param"><span class="n">dipole</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dof_set</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.onsite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.pbond_list">
<em class="property">property </em><code class="sig-name descname">pbond_list</code><a class="headerlink" href="#renormalizer.mps.MpDm.pbond_list" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.ph_occupations">
<em class="property">property </em><code class="sig-name descname">ph_occupations</code><a class="headerlink" href="#renormalizer.mps.MpDm.ph_occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>phonon occupations <span class="math notranslate nohighlight">\(b^\dagger_i b_i\)</span> for each electronic DoF.
The order is defined by <code class="xref py py-attr docutils literal notranslate"><span class="pre">v_dofs</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.ph_onsite">
<em class="property">classmethod </em><code class="sig-name descname">ph_onsite</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.HolsteinModel</span></em>, <em class="sig-param"><span class="n">opera</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em>, <em class="sig-param"><span class="n">mol_idx</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span></em>, <em class="sig-param"><span class="n">ph_idx</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.ph_onsite" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.promote_mt_type">
<code class="sig-name descname">promote_mt_type</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mp</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.promote_mt_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.random">
<em class="property">classmethod </em><code class="sig-name descname">random</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span></em>, <em class="sig-param"><span class="n">nexciton</span></em>, <em class="sig-param"><span class="n">m_max</span></em>, <em class="sig-param"><span class="n">percent</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/mpdm.html#MpDm.random"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.MpDm.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.scale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.set_threshold">
<code class="sig-name descname">set_threshold</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">val</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.set_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.site_num">
<em class="property">property </em><code class="sig-name descname">site_num</code><a class="headerlink" href="#renormalizer.mps.MpDm.site_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.threshold">
<em class="property">property </em><code class="sig-name descname">threshold</code><a class="headerlink" href="#renormalizer.mps.MpDm.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.to_complex">
<code class="sig-name descname">to_complex</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inplace</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; renormalizer.mps.mps.Mps<a class="headerlink" href="#renormalizer.mps.MpDm.to_complex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.total_bytes">
<em class="property">property </em><code class="sig-name descname">total_bytes</code><a class="headerlink" href="#renormalizer.mps.MpDm.total_bytes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.MpDm.variational_compress">
<code class="sig-name descname">variational_compress</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mpo</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">guess</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.MpDm.variational_compress" title="Permalink to this definition">¶</a></dt>
<dd><p>Variational compress an mps/mpdm/mpo</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mpo</strong> (<a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><em>renormalizer.mps.Mpo</em></a><em>, </em><em>optional</em>) – Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. if mpo is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, the returned mps is
an approximation of <code class="docutils literal notranslate"><span class="pre">mpo</span> <span class="pre">&#64;</span> <span class="pre">self</span></code></p></li>
<li><p><strong>guess</strong> (<em>renormalizer.mps.MatrixProduct</em><em>, </em><em>optional</em>) – Initial guess of compressed mps/mpdm/mpo. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the variational compress related configurations is defined in
<code class="docutils literal notranslate"><span class="pre">self</span></code> if <code class="docutils literal notranslate"><span class="pre">guess=None</span></code>, otherwise is defined in <code class="docutils literal notranslate"><span class="pre">guess</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>mp</strong> – a new compressed mps/mpdm/mpo, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not overwritten.
<code class="docutils literal notranslate"><span class="pre">guess</span></code> is overwritten.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>renormalizer.mps.MatrixProduct</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-renormalizer.mps.thermalprop">
<span id="thermal-propagation"></span><h2><span class="section-number">6.5. </span>Thermal Propagation<a class="headerlink" href="#module-renormalizer.mps.thermalprop" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.mps.thermalprop.ThermalProp">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.mps.thermalprop.</code><code class="sig-name descname">ThermalProp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_mpdm</span><span class="p">:</span> <span class="n">renormalizer.mps.mpdm.MpDm</span></em>, <em class="sig-param"><span class="n">h_mpo</span><span class="p">:</span> <span class="n">renormalizer.mps.mpo.Mpo</span></em>, <em class="sig-param"><span class="n">exact</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">space</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">'GS'</span></em>, <em class="sig-param"><span class="n">evolve_config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="configs.html#renormalizer.utils.configs.EvolveConfig" title="renormalizer.utils.configs.EvolveConfig">renormalizer.utils.configs.EvolveConfig</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dump_mps</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dump_dir</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">job_name</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">properties</span><span class="p">:</span> <span class="n">renormalizer.property.property.Property</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">auto_expand</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">renormalizer.utils.tdmps.TdMpsJob</span></code></p>
<p>Thermally Propagate initial matrix product density operator (<a class="reference internal" href="#renormalizer.mps.MpDm" title="renormalizer.mps.MpDm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpDm</span></code></a>) in imaginary time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_mpdm</strong> (<a class="reference internal" href="#renormalizer.mps.MpDm" title="renormalizer.mps.MpDm"><code class="xref py py-class docutils literal notranslate"><span class="pre">MpDm</span></code></a>) – the initial density matrix to be propagated. Usually identity.</p></li>
<li><p><strong>h_mpo</strong> (<a class="reference internal" href="#renormalizer.mps.Mpo" title="renormalizer.mps.Mpo"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mpo</span></code></a>) – the system Hamiltonian.</p></li>
<li><p><strong>exact</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether propagate assuming Hamiltonian is local
<span class="math notranslate nohighlight">\(\hat H = \sum_i \hat H_i = \sum_{in} \omega_{in} b^\dagger_{in} b_{in}\)</span> and
exact propagation is possible through <span class="math notranslate nohighlight">\(e^{xH} = e^{xh_1}e^{xh_2} \cdots e^{xh_n}\)</span>.
If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, properties such as occupations are not calculated during
time evolution for better efficiency.</p></li>
<li><p><strong>space</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the space of exact propagation. Possible options are <code class="docutils literal notranslate"><span class="pre">&quot;GS&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;EX&quot;</span></code>.
If set to <code class="docutils literal notranslate"><span class="pre">&quot;GS&quot;</span></code>, then the exact propagation is performed in zero exciton space.
If set to <code class="docutils literal notranslate"><span class="pre">&quot;EX&quot;</span></code>, then the exact propagation is performed in one exciton space,
i.e. the vibrations are regarded as displaced oscillators.</p></li>
<li><p><strong>evolve_config</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">EvolveConfig</span></code>) – config when evolving the MpDm in imaginary time.</p></li>
<li><p><strong>dump_mps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – if dump mps when dumping</p></li>
<li><p><strong>dump_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the directory for logging and numerical result output.</p></li>
<li><p><strong>job_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the name of the calculation job which determines the file name of the logging and numerical result output.</p></li>
<li><p><strong>properties</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Property</span></code>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.dump_dict">
<code class="sig-name descname">dump_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.dump_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.e_occupations_array">
<em class="property">property </em><code class="sig-name descname">e_occupations_array</code><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.e_occupations_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.evolve">
<code class="sig-name descname">evolve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">evolve_dt</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">evolve_time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.evolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.evolve" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evolve_dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – the time step to run <a class="reference internal" href="#renormalizer.mps.thermalprop.ThermalProp.evolve_single_step" title="renormalizer.mps.thermalprop.ThermalProp.evolve_single_step"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">evolve_single_step</span></code></a> and <a class="reference internal" href="#renormalizer.mps.thermalprop.ThermalProp.process_mps" title="renormalizer.mps.thermalprop.ThermalProp.process_mps"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">process_mps</span></code></a>.</p></li>
<li><p><strong>nsteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – the total number of evolution steps</p></li>
<li><p><strong>evolve_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – the total evolution time</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">evolve_dt</span></code> math: `       imes` <code class="docutils literal notranslate"><span class="pre">nsteps</span></code> = <code class="docutils literal notranslate"><span class="pre">evolve_time</span></code>,  otherwise nsteps has a higher priority.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.evolve_exact">
<code class="sig-name descname">evolve_exact</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_mpdm</span><span class="p">:</span> <span class="n">renormalizer.mps.mpdm.MpDm</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.evolve_exact"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.evolve_exact" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.evolve_prop">
<code class="sig-name descname">evolve_prop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">old_mpdm</span></em>, <em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.evolve_prop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.evolve_prop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.evolve_single_step">
<code class="sig-name descname">evolve_single_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.evolve_single_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.evolve_single_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve the mps for a single step with step size <code class="docutils literal notranslate"><span class="pre">evolve_dt</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new mps after the evolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.evolve_times_array">
<em class="property">property </em><code class="sig-name descname">evolve_times_array</code><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.evolve_times_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.get_dump_dict">
<code class="sig-name descname">get_dump_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.get_dump_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.get_dump_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain calculated properties to dump in <code class="docutils literal notranslate"><span class="pre">dict</span></code> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return a (ordered) dict to dump as npz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.init_mps">
<code class="sig-name descname">init_mps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.init_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.init_mps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>initial mps of the system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.latest_evolve_time">
<em class="property">property </em><code class="sig-name descname">latest_evolve_time</code><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.latest_evolve_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.ph_occupations_array">
<em class="property">property </em><code class="sig-name descname">ph_occupations_array</code><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.ph_occupations_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.process_mps">
<code class="sig-name descname">process_mps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#ThermalProp.process_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.process_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.stop_evolve_criteria">
<code class="sig-name descname">stop_evolve_criteria</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.stop_evolve_criteria" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.mps.thermalprop.ThermalProp.vn_entropy_array">
<em class="property">property </em><code class="sig-name descname">vn_entropy_array</code><a class="headerlink" href="#renormalizer.mps.thermalprop.ThermalProp.vn_entropy_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="renormalizer.mps.thermalprop.load_thermal_state">
<code class="sig-prename descclassname">renormalizer.mps.thermalprop.</code><code class="sig-name descname">load_thermal_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/mps/thermalprop.html#load_thermal_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.mps.thermalprop.load_thermal_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Load thermal propagated state from disk. Return None if the file is not found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">MolList</span></code>) – system information</p></li>
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the path to load thermal state from. Should be an numpy <code class="docutils literal notranslate"><span class="pre">.npz</span></code> file.</p></li>
</ul>
</dd>
</dl>
<p>Returns: Loaded MpDm</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="static.html" class="btn btn-neutral float-right" title="7. Static Eigenstate Method" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="model.html" class="btn btn-neutral float-left" title="5. Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Shuaigroup

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>