

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9. Charge Transport &mdash; Renormalizer 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. Frequency domain DMRG" href="cv.html" />
    <link rel="prev" title="8. spectra: absorption/emission spectrum at zero/finite temperature" href="spectrum.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Renormalizer
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">1. An overview of Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="develop.html">3. How to develop Renormalizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">4. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">5. Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="mps.html">6. Low Level Data Structure and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="static.html">7. Static Eigenstate Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectrum.html">8. spectra: absorption/emission spectrum at zero/finite temperature</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">9. Charge Transport</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-renormalizer.transport.kubo">9.1. Obtain mobility by Green-Kubo formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-renormalizer.transport.dynamics">9.2. Charge diffusion dynamics simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cv.html">10. Frequency domain DMRG</a></li>
<li class="toctree-l1"><a class="reference internal" href="configs.html">11. Calculation Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">12. lib</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbm.html">13. sbm</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Renormalizer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">9. </span>Charge Transport</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/ct.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="charge-transport">
<h1><span class="section-number">9. </span>Charge Transport<a class="headerlink" href="#charge-transport" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-renormalizer.transport.kubo">
<span id="obtain-mobility-by-green-kubo-formula"></span><h2><span class="section-number">9.1. </span>Obtain mobility by Green-Kubo formula<a class="headerlink" href="#module-renormalizer.transport.kubo" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.transport.kubo.TransportKubo">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.transport.kubo.</code><code class="sig-name descname">TransportKubo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">renormalizer.model.model.Model</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">renormalizer.utils.quantity.Quantity</span></em>, <em class="sig-param"><span class="n">distance_matrix</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">insteps</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">ievolve_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compress_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">evolve_config</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dump_dir</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">job_name</span><span class="p">:</span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">properties</span><span class="p">:</span> <span class="n">renormalizer.property.property.Property</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate mobility via Green-Kubo formula:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\mu = \frac{1}{k_B T} \int_0^\infty dt \langle \hat j (t) \hat j(0) \rangle
= \frac{1}{k_B T} \int_0^\infty dt C(t)\]</div>
</div></blockquote>
<p>where</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\hat j = -\frac{i}{\hbar}[\hat P, \hat H]\]</div>
</div></blockquote>
<p>and <span class="math notranslate nohighlight">\(\hat P = e_0 \sum_m R_m a^\dagger_m a_m\)</span> is the polarization operator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although in principle <span class="math notranslate nohighlight">\(\hat H\)</span> can take any form, only Holstein-Peierls model are well tested.</p>
</div>
<p>More explicitly, <span class="math notranslate nohighlight">\(C(t)\)</span> has the form:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[C(t) = \textrm{Tr}\{\rho(T) e^{i \hat H t} \hat j(0) e^{- i \hat H t} \hat j (0)\}\]</div>
</div></blockquote>
<p>where we have assumed <span class="math notranslate nohighlight">\(\rho(T)\)</span> is normalized
(i.e. it is divided by the partition function <span class="math notranslate nohighlight">\(\textrm{Tr}\{\rho(T)\}\)</span>).</p>
<p>In terms of practical implementation, it is ideal if <span class="math notranslate nohighlight">\(\rho(T)\)</span> is split into two parts
to (hopefully) speed up calculation and minimize time evolution error:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
 C(t) &amp; = \textrm{Tr}\{\rho(T) e^{i \hat H t} \hat j(0) e^{- i \hat H t} \hat j(0)\} \\
      &amp; = \textrm{Tr}\{e^{-\beta \hat H} e^{i \hat H t} \hat j(0) e^{- i \hat H t} \hat j(0)\} \\
      &amp; = \textrm{Tr}\{e^{-\beta \hat H / 2} e^{i \hat H t} \hat j(0) e^{- i \hat H t} \hat j(0) e^{-\beta \hat H / 2}\}
\end{align}\end{split}\]</div>
</div></blockquote>
<p>In this class, imaginary time propagation from infinite temperature to <span class="math notranslate nohighlight">\(\beta/2\)</span> is firstly carried out
to obtain <span class="math notranslate nohighlight">\(e^{-\beta \hat H / 2}\)</span>, and then real time propagation is carried out for <span class="math notranslate nohighlight">\(e^{-\beta \hat H / 2}\)</span>
and <span class="math notranslate nohighlight">\(\hat J(0) e^{-\beta \hat H / 2}\)</span> respectively to obtain <span class="math notranslate nohighlight">\(e^{-\beta \hat H / 2} e^{i \hat H t}\)</span>
and <span class="math notranslate nohighlight">\(e^{- i \hat H t} \hat j(0) e^{-\beta \hat H / 2}\)</span>. The correlation function at time <span class="math notranslate nohighlight">\(t\)</span> can thus
be calculated via expectation calculation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the class is able to carry out imaginary time propagation, in practice for large scale calculation
it is usually preferable to carry out imaginary time propagation in another job and load the dumped initial
state directly in this class.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="model.html#renormalizer.model.Model" title="renormalizer.model.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a>) – system information.</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code>) – simulation temperature.
Zero temperature is not supported.</p></li>
<li><p><strong>distance_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – <p>two-dimensional array <span class="math notranslate nohighlight">\(D_{ij} = P_i - P_j\)</span> representing
distance between the <span class="math notranslate nohighlight">\(i\)</span> th electronic degree of freedom and the <span class="math notranslate nohighlight">\(j\)</span> th degree of freedom.
The parameter takes the role of <span class="math notranslate nohighlight">\(\hat P\)</span> and can better handle periodic boundary condition.
The default value is <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case the distance matrix is constructed assuming the system
is a one-dimensional chain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The construction of the matrix should be taken with great care if periodic boundary condition
is applied. Take a one-dimensional chain as an example, the distance between the leftmost site
and the rightmost site is <span class="math notranslate nohighlight">\(\pm R\)</span> where <span class="math notranslate nohighlight">\(R\)</span> is the intersite distance,
rather than <span class="math notranslate nohighlight">\(\pm (N-1)R\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the total number of electronic degrees of freedom.</p>
</div>
</p></li>
<li><p><strong>insteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – steps for imaginary time propagation.</p></li>
<li><p><strong>ievolve_config</strong> (<a class="reference internal" href="configs.html#renormalizer.utils.configs.EvolveConfig" title="renormalizer.utils.configs.EvolveConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvolveConfig</span></code></a>) – config when carrying out imaginary time propagation.</p></li>
<li><p><strong>compress_config</strong> (<a class="reference internal" href="configs.html#renormalizer.utils.configs.CompressConfig" title="renormalizer.utils.configs.CompressConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompressConfig</span></code></a>) – config when compressing MPS.
Note that even if TDVP based methods are chosen for time evolution, compression is still necessary
when <span class="math notranslate nohighlight">\(\hat j\)</span> is applied on <span class="math notranslate nohighlight">\(\rho^{\frac{1}{2}}\)</span>.</p></li>
<li><p><strong>evolve_config</strong> (<a class="reference internal" href="configs.html#renormalizer.utils.configs.EvolveConfig" title="renormalizer.utils.configs.EvolveConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvolveConfig</span></code></a>) – config when carrying out real time propagation.</p></li>
<li><p><strong>dump_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the directory for logging and numerical result output.
Also the directory from which to load previous thermal propagated initial state (if exists).</p></li>
<li><p><strong>job_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the name of the calculation job which determines the file name of the logging and numerical result output.
For thermal propagated initial state input/output the file name is appended with <code class="docutils literal notranslate"><span class="pre">&quot;_impdm.npz&quot;</span></code>.</p></li>
<li><p><strong>properties</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Property</span></code>) – other properties to calculate during real time evolution.
Currently only supports Holstein model.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.auto_corr">
<em class="property">property </em><code class="sig-name descname">auto_corr</code><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.auto_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlation function <span class="math notranslate nohighlight">\(C(t)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>1-d numpy array containing the correlation function evaluated at each time step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.auto_corr_decomposition">
<em class="property">property </em><code class="sig-name descname">auto_corr_decomposition</code><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.auto_corr_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Correlation function <span class="math notranslate nohighlight">\(C(t)\)</span> decomposed into contributions from different parts
of the current operator. Generally, the current operator can be split into two parts:
current without phonon assistance and current with phonon assistance.
For example, if the Holstein-Peierls model is considered:</p>
<div class="math notranslate nohighlight">
\[\hat H = \sum_{mn}  [\epsilon_{mn} + \sum_\lambda \hbar g_{mn\lambda} \omega_\lambda
(b^\dagger_\lambda + b_\lambda) ] a^\dagger_m a_n
+ \sum_\lambda \hbar \omega_\lambda b^\dagger_\lambda  b_\lambda\]</div>
<p>Then current operator without phonon assistance is defined as:</p>
<div class="math notranslate nohighlight">
\[\hat j_1 = \frac{e_0}{i\hbar} \sum_{mn} (R_m - R_n) \epsilon_{mn} a^\dagger_m a_n\]</div>
<p>and the current operator with phonon assistance is defined as:</p>
<div class="math notranslate nohighlight">
\[\hat j_2 = \frac{e_0}{i\hbar} \sum_{mn} (R_m - R_n) \hbar g_{mn\lambda} \omega_\lambda
(b^\dagger_\lambda + b_\lambda) a^\dagger_m a_n\]</div>
<p>With <span class="math notranslate nohighlight">\(\hat j = \hat j_1 + \hat j_2\)</span>, the correlation function can be
decomposed into four parts:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
C(t) &amp; = \langle \hat j(t) \hat j(0) \rangle \\
     &amp; = \langle ( \hat j_1(t) + \hat j_2(t) ) (\hat j_1(0) + \hat j_2(0) ) \rangle \\
     &amp; = \langle \hat j_1(t) \hat j_1(0) \rangle + \langle \hat j_1(t) \hat j_2(0) \rangle
     + \langle \hat j_2(t) \hat j_1(0) \rangle + \langle \hat j_2(t) \hat j_2(0) \rangle
\end{align}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><span class="math notranslate nohighlight">\(n \times 4\)</span> array for the decomposed correlation function defined as above
where <span class="math notranslate nohighlight">\(n\)</span> is the number of time steps.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.calc_mobility">
<code class="sig-name descname">calc_mobility</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.calc_mobility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.calc_mobility" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.evolve_single_step">
<code class="sig-name descname">evolve_single_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.evolve_single_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.evolve_single_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve the mps for a single step with step size <code class="docutils literal notranslate"><span class="pre">evolve_dt</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new mps after the evolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.get_dump_dict">
<code class="sig-name descname">get_dump_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.get_dump_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.get_dump_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain calculated properties to dump in <code class="docutils literal notranslate"><span class="pre">dict</span></code> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return a (ordered) dict to dump as npz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.init_mps">
<code class="sig-name descname">init_mps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.init_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.init_mps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>initial mps of the system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.process_mps">
<code class="sig-name descname">process_mps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.process_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.process_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.kubo.TransportKubo.stop_evolve_criteria">
<code class="sig-name descname">stop_evolve_criteria</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/kubo.html#TransportKubo.stop_evolve_criteria"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.kubo.TransportKubo.stop_evolve_criteria" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-renormalizer.transport.dynamics">
<span id="charge-diffusion-dynamics-simulation"></span><h2><span class="section-number">9.2. </span>Charge diffusion dynamics simulation<a class="headerlink" href="#module-renormalizer.transport.dynamics" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.transport.dynamics.</code><code class="sig-name descname">ChargeDiffusionDynamics</code><span class="sig-paren">(</span><em class="sig-param">model: renormalizer.model.model.HolsteinModel</em>, <em class="sig-param">temperature: renormalizer.utils.quantity.Quantity = &lt;renormalizer.utils.quantity.Quantity object&gt;</em>, <em class="sig-param">compress_config: renormalizer.utils.configs.CompressConfig = None</em>, <em class="sig-param">evolve_config: renormalizer.utils.configs.EvolveConfig = None</em>, <em class="sig-param">stop_at_edge: bool = True</em>, <em class="sig-param">init_electron=&lt;InitElectron.relaxed: 'analytically relaxed phonon(s)'&gt;</em>, <em class="sig-param">rdm: bool = False</em>, <em class="sig-param">dump_dir: str = None</em>, <em class="sig-param">job_name: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate charge diffusion dynamics by TD-DMRG. It is possible to obtain mobility from the simulation,
but care must be taken to ensure that mean square displacement grows linearly with time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">HolsteinModel</span></code>) – system information.
Currently only support <code class="xref py py-class docutils literal notranslate"><span class="pre">HolsteinModel</span></code>.</p></li>
<li><p><strong>temperature</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code>) – simulation temperature. Default is zero temperature.</p></li>
<li><p><strong>compress_config</strong> (<a class="reference internal" href="configs.html#renormalizer.utils.configs.CompressConfig" title="renormalizer.utils.configs.CompressConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompressConfig</span></code></a>) – config when compressing MPS.</p></li>
<li><p><strong>evolve_config</strong> (<a class="reference internal" href="configs.html#renormalizer.utils.configs.EvolveConfig" title="renormalizer.utils.configs.EvolveConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvolveConfig</span></code></a>) – config when evolving MPS.</p></li>
<li><p><strong>stop_at_edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether stop when charge has diffused to the boundary of the system. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>init_electron</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">InitElectron</span></code>) – the method to prepare the initial state.</p></li>
<li><p><strong>rdm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether calculate reduced density matrix and k-space representation for the electron.
Default is <code class="docutils literal notranslate"><span class="pre">False</span></code> because usually the calculation is time consuming.
Using scheme 4 might partly solve the problem.</p></li>
<li><p><strong>dump_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the directory for logging and numerical result output.
Also the directory from which to load previous thermal propagated initial state (if exists).</p></li>
<li><p><strong>job_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – the name of the calculation job which determines the file name of the logging and numerical result output.
For thermal propagated initial state input/output the file name is appended with <code class="docutils literal notranslate"><span class="pre">&quot;_impdm.npz&quot;</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.energies">
<code class="sig-name descname">energies</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated energy of the states during the time evolution.
Without dissipation or TD-Hartree the value should remain unchanged and to some extent
can be used to measure the error during time evolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.r_square_array">
<code class="sig-name descname">r_square_array</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.r_square_array" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated mean square displacement
<span class="math notranslate nohighlight">\(\langle \psi | \hat r^2 | \psi \rangle - \langle \psi | \hat r | \psi \rangle^2\)</span>
at each evolution time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.e_occupations_array">
<code class="sig-name descname">e_occupations_array</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.e_occupations_array" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated electron occupations in real space on each site for each evolution time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.ph_occupations_array">
<code class="sig-name descname">ph_occupations_array</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.ph_occupations_array" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated phonon occupations on each site for each evolution time step.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.reduced_density_matrices">
<code class="sig-name descname">reduced_density_matrices</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.reduced_density_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated reduced density matrices of the electron for each evolution time step.
Only available when <code class="docutils literal notranslate"><span class="pre">rdm</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.k_occupations_array">
<code class="sig-name descname">k_occupations_array</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.k_occupations_array" title="Permalink to this definition">¶</a></dt>
<dd><p>calculated electron occupations in momentum (k) space
on each site for each evolution time step. Only available when <code class="docutils literal notranslate"><span class="pre">rdm</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The basis transformation is based on:</p>
<div class="math notranslate nohighlight">
\[| k \rangle = \sum_j e^{-ijk} | j \rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> starts from <span class="math notranslate nohighlight">\(-\pi\)</span> to <span class="math notranslate nohighlight">\(\pi\)</span> with interval <span class="math notranslate nohighlight">\(2\pi/N\)</span>.
<span class="math notranslate nohighlight">\(N\)</span> represents total number of electronic sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.coherent_length_array">
<code class="sig-name descname">coherent_length_array</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.coherent_length_array" title="Permalink to this definition">¶</a></dt>
<dd><p>coherent length <span class="math notranslate nohighlight">\(L\)</span> calculated for each evolution time step.</p>
<div class="math notranslate nohighlight">
\[L = \sum_{ij, i \neq j} | \rho_{ij} |\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the density matrix of the electron. Naturally this is only available when
<code class="docutils literal notranslate"><span class="pre">rdm</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron">
<code class="sig-name descname">create_electron</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gs_mp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.create_electron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron_fc">
<code class="sig-name descname">create_electron_fc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gs_mp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.create_electron_fc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron_fc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron_relaxed">
<code class="sig-name descname">create_electron_relaxed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gs_mp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.create_electron_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.create_electron_relaxed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.evolve_single_step">
<code class="sig-name descname">evolve_single_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">evolve_dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.evolve_single_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.evolve_single_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Evolve the mps for a single step with step size <code class="docutils literal notranslate"><span class="pre">evolve_dt</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>new mps after the evolution</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.get_dump_dict">
<code class="sig-name descname">get_dump_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.get_dump_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.get_dump_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain calculated properties to dump in <code class="docutils literal notranslate"><span class="pre">dict</span></code> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>return a (ordered) dict to dump as npz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.init_mps">
<code class="sig-name descname">init_mps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.init_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.init_mps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>initial mps of the system</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.is_similar">
<code class="sig-name descname">is_similar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics" title="renormalizer.transport.dynamics.ChargeDiffusionDynamics">renormalizer.transport.dynamics.ChargeDiffusionDynamics</a></span></em>, <em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">0.001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.is_similar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.is_similar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.mol_num">
<em class="property">property </em><code class="sig-name descname">mol_num</code><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.mol_num" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.process_mps">
<code class="sig-name descname">process_mps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mps</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.process_mps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.process_mps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="renormalizer.transport.dynamics.ChargeDiffusionDynamics.stop_evolve_criteria">
<code class="sig-name descname">stop_evolve_criteria</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#ChargeDiffusionDynamics.stop_evolve_criteria"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.ChargeDiffusionDynamics.stop_evolve_criteria" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="renormalizer.transport.dynamics.InitElectron">
<em class="property">class </em><code class="sig-prename descclassname">renormalizer.transport.dynamics.</code><code class="sig-name descname">InitElectron</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#InitElectron"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.InitElectron" title="Permalink to this definition">¶</a></dt>
<dd><p>Available methods to prepare initial state of charge diffusion</p>
<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.InitElectron.fc">
<code class="sig-name descname">fc</code><em class="property"> = 'franck-condon excitation'</em><a class="headerlink" href="#renormalizer.transport.dynamics.InitElectron.fc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="renormalizer.transport.dynamics.InitElectron.relaxed">
<code class="sig-name descname">relaxed</code><em class="property"> = 'analytically relaxed phonon(s)'</em><a class="headerlink" href="#renormalizer.transport.dynamics.InitElectron.relaxed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="renormalizer.transport.dynamics.calc_r_square">
<code class="sig-prename descclassname">renormalizer.transport.dynamics.</code><code class="sig-name descname">calc_r_square</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e_occupations</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/renormalizer/transport/dynamics.html#calc_r_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#renormalizer.transport.dynamics.calc_r_square" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cv.html" class="btn btn-neutral float-right" title="10. Frequency domain DMRG" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spectrum.html" class="btn btn-neutral float-left" title="8. spectra: absorption/emission spectrum at zero/finite temperature" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Shuaigroup

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>